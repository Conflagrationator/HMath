<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CLaSH.Prelude.BlockRam</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_CLaSH-Prelude-BlockRam.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">clash-prelude-0.11: CAES Language for Synchronous Hardware - Prelude library</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(C) 2013-2016 University of Twente</td></tr><tr><th>License</th><td>BSD2 (see the file LICENSE)</td></tr><tr><th>Maintainer</th><td>Christiaan Baaij &lt;christiaan.baaij@gmail.com&gt;</td></tr><tr><th>Safe Haskell</th><td>Trustworthy</td></tr><tr><th>Language</th><td>Haskell2010</td></tr><tr><th>Extensions</th><td><ul class="extension-list"><li>ScopedTypeVariables</li><li>DataKinds</li><li>MagicHash</li><li>TypeOperators</li><li>ExplicitNamespaces</li><li>ExplicitForAll</li></ul></td></tr></table><p class="caption">CLaSH.Prelude.BlockRam</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">BlockRAM synchronised to the system clock</a></li><li><a href="#g:2">BlockRAM synchronised to an arbitrary clock</a></li><li><a href="#g:3">Read/Write conflict resolution</a></li><li><a href="#g:4">Internal</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>BlockRAM primitives</p><h1>Using RAMs <a id="usingrams"></a></h1><p>We will show a rather elaborate example on how you can, and why you might want
to use <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code>s. We will build a &quot;small&quot; CPU+Memory+Program ROM where we
will slowly evolve to using blockRams. Note that the code is <em>not</em> meant as a
de-facto standard on how to do CPU design in C&#955;aSH.</p><p>We start with the definition of the Instructions, Register names and machine
codes:</p><pre>{-# LANGUAGE RecordWildCards, TupleSections #-}
module CPU where

import CLaSH.Prelude

type InstrAddr = Unsigned 8
type MemAddr   = Unsigned 5
type Value     = Signed 8

data Instruction
  = Compute Operator Reg Reg Reg
  | Branch Reg Value
  | Jump Value
  | Load MemAddr Reg
  | Store Reg MemAddr
  | Nop
  deriving (Eq,Show)

data Reg
  = Zero
  | PC
  | RegA
  | RegB
  | RegC
  | RegD
  | RegE
  deriving (Eq,Show,Enum)

data Operator = Add | Sub | Incr | Imm | CmpGt
  deriving (Eq,Show)

data MachCode
  = MachCode
  { inputX  :: Reg
  , inputY  :: Reg
  , result  :: Reg
  , aluCode :: Operator
  , ldReg   :: Reg
  , rdAddr  :: MemAddr
  , wrAddrM :: Maybe MemAddr
  , jmpM    :: Maybe Value
  }

nullCode = MachCode { inputX = Zero, inputY = Zero, result = Zero, aluCode = Imm
                    , ldReg = Zero, rdAddr = 0, wrAddrM = Nothing
                    , jmpM = Nothing
                    }
</pre><p>Next we define the CPU and its ALU:</p><pre>cpu :: Vec 7 Value          -- ^ Register bank
    -&gt; (Value,Instruction)  -- ^ (Memory output, Current instruction)
    -&gt; ( Vec 7 Value
       , (MemAddr, Maybe (MemAddr,Value), InstrAddr)
       )
cpu regbank (memOut,instr) = (regbank',(rdAddr,(,aluOut) <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Functor.html#v:-60--36--62-">&lt;$&gt;</a></code> wrAddrM,fromIntegral ipntr))
  where
    -- Current instruction pointer
    ipntr = regbank <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code> PC

    -- Decoder
    (MachCode {..}) = case instr of
      Compute op rx ry res -&gt; nullCode {inputX=rx,inputY=ry,result=res,aluCode=op}
      Branch cr a          -&gt; nullCode {inputX=cr,jmpM=Just a}
      Jump a               -&gt; nullCode {aluCode=Incr,jmpM=Just a}
      Load a r             -&gt; nullCode {ldReg=r,rdAddr=a}
      Store r a            -&gt; nullCode {inputX=r,wrAddrM=Just a}
      Nop                  -&gt; nullCode

    -- ALU
    regX   = regbank <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code> inputX
    regY   = regbank <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code> inputY
    aluOut = alu aluCode regX regY

    -- next instruction
    nextPC = case jmpM of
               Just a | aluOut /= 0 -&gt; ipntr + a
               _                    -&gt; ipntr + 1

    -- update registers
    regbank' = <code>replace</code> Zero   0
             $ <code>replace</code> PC     nextPC
             $ <code>replace</code> result aluOut
             $ <code>replace</code> ldReg  memOut
             $ regbank

alu Add   x y = x + y
alu Sub   x y = x - y
alu Incr  x _ = x + 1
alu Imm   x _ = x
alu CmpGt x y = if x &gt; y then 1 else 0
</pre><p>We initially create a memory out of simple registers:</p><pre>dataMem :: Signal MemAddr                 -- ^ Read address
        -&gt; Signal (Maybe (MemAddr,Value)) -- ^ (write address, data in)
        -&gt; Signal Value                   -- ^ data out
dataMem rd wrM = <code><a href="CLaSH-Prelude-Mealy.html#v:mealy">mealy</a></code> dataMemT (<code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:replicate">replicate</a></code> d32 0) (bundle (rd,wrM))
  where
    dataMemT mem (rd,wrM) = (mem',dout)
      where
        dout = mem <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code> rd
        mem' = case wrM of
                 Just (wr,din) -&gt; <code>replace</code> wr din mem
                 _ -&gt; mem
</pre><p>And then connect everything:</p><pre>system :: KnownNat n =&gt; Vec n Instruction -&gt; Signal Value
system instrs = memOut
  where
    memOut = dataMem rdAddr dout
    (rdAddr,dout,ipntr) = <code><a href="CLaSH-Prelude-Mealy.html#v:mealyB">mealyB</a></code> cpu (<code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:replicate">replicate</a></code> d7 0) (memOut,instr)
    instr  = <code><a href="CLaSH-Prelude-ROM.html#v:asyncRom">asyncRom</a></code> instrs <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Functor.html#v:-60--36--62-">&lt;$&gt;</a></code> ipntr
</pre><p>Create a simple program that calculates the GCD of 4 and 6:</p><pre>-- Compute GCD of 4 and 6
prog = -- 0 := 4
       Compute Incr Zero RegA RegA :&gt;
       replicate d3 (Compute Incr RegA Zero RegA) ++
       Store RegA 0 :&gt;
       -- 1 := 6
       Compute Incr Zero RegA RegA :&gt;
       replicate d5 (Compute Incr RegA Zero RegA) ++
       Store RegA 1 :&gt;
       -- A := 4
       Load 0 RegA :&gt;
       -- B := 6
       Load 1 RegB :&gt;
       -- start
       Compute CmpGt RegA RegB RegC :&gt;
       Branch RegC 4 :&gt;
       Compute CmpGt RegB RegA RegC :&gt;
       Branch RegC 4 :&gt;
       Jump 5 :&gt;
       -- (a &gt; b)
       Compute Sub RegA RegB RegA :&gt;
       Jump (-6) :&gt;
       -- (b &gt; a)
       Compute Sub RegB RegA RegB :&gt;
       Jump (-8) :&gt;
       -- end
       Store RegA 2 :&gt;
       Load 2 RegC :&gt;
       Nil
</pre><p>And test our system:</p><pre>&gt;&gt;&gt; sampleN 31 $ system prog
[0,0,0,0,0,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2]

</pre><p>to see that our system indeed calculates that the GCD of 6 and 4 is 2.</p><h3>Improvement 1: using <code>asyncRam</code></h3><p>As you can see, it's fairly straightforward to build a memory using registers
and read (<code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code>) and write (<code>replace</code>) logic. This might however not result in
the most efficient hardware structure, especially when building an ASIC.</p><p>Instead it is preferable to use the <code><a href="CLaSH-Prelude-RAM.html#v:asyncRam">asyncRam</a></code> function which
has the potential to be translated to a more efficient structure:</p><pre>system2 :: KnownNat n =&gt; Vec n Instruction -&gt; Signal Value
system2 instrs = memOut
  where
    memOut = <code><a href="CLaSH-Prelude-RAM.html#v:asyncRam">asyncRam</a></code> d32 rdAddr dout
    (rdAddr,dout,ipntr) = <code>mealyB</code> cpu (<code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:replicate">replicate</a></code> d7 0) (memOut,instr)
    instr  = <code><a href="CLaSH-Prelude-ROM.html#v:asyncRom">asyncRom</a></code> instrs <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Functor.html#v:-60--36--62-">&lt;$&gt;</a></code> ipntr
</pre><p>Again, we can simulate our system and see that it works. This time however,
we need to drop the first few output samples, because the initial content of an
<code><a href="CLaSH-Prelude-RAM.html#v:asyncRam">asyncRam</a></code> is <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code>, and consequently, the first few
output samples are also <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code>.</p><pre>&gt;&gt;&gt; printX $ sampleN 31 $ system2 prog
[X,X,X,X,X,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2]

</pre><h3>Improvement 2: using <code>blockRam</code></h3><p>Finally we get to using <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code>. On FPGAs, <code><a href="CLaSH-Prelude-RAM.html#v:asyncRam">asyncRam</a></code> will
be implemented in terms of LUTs, and therefore take up logic resources. FPGAs
also have large(r) memory structures called <em>Block RAMs</em>, which are preferred,
especially as the memories we need for our application get bigger. The
<code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code> function will be translated to such a <em>Block RAM</em>.</p><p>One important aspect of Block RAMs have a <em>synchronous</em> read port, meaning that,
unlike the behaviour of <code><a href="CLaSH-Prelude-RAM.html#v:asyncRam">asyncRam</a></code>, given a read address <code>r</code>
at time <code>t</code>, the value <code>v</code> in the RAM at address <code>r</code> is only available at time
<code>t+1</code>.</p><p>For us that means we need to change the design of our CPU. Right now, upon a
load instruction we generate a read address for the memory, and the value at
that read address is immediately available to be put in the register bank.
Because we will be using a BlockRAM, the value is delayed until the next cycle.
We hence need to also delay the register address to which the memory address
is loaded:</p><pre>cpu2 :: (Vec 7 Value,Reg)    -- ^ (Register bank, Load reg addr)
     -&gt; (Value,Instruction)  -- ^ (Memory output, Current instruction)
     -&gt; ( (Vec 7 Value,Reg)
        , (MemAddr, Maybe (MemAddr,Value), InstrAddr)
        )
cpu2 (regbank,ldRegD) (memOut,instr) = ((regbank',ldRegD'),(rdAddr,(,aluOut) <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Functor.html#v:-60--36--62-">&lt;$&gt;</a></code> wrAddrM,fromIntegral ipntr))
  where
    -- Current instruction pointer
    ipntr = regbank <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code> PC

    -- Decoder
    (MachCode {..}) = case instr of
      Compute op rx ry res -&gt; nullCode {inputX=rx,inputY=ry,result=res,aluCode=op}
      Branch cr a          -&gt; nullCode {inputX=cr,jmpM=Just a}
      Jump a               -&gt; nullCode {aluCode=Incr,jmpM=Just a}
      Load a r             -&gt; nullCode {ldReg=r,rdAddr=a}
      Store r a            -&gt; nullCode {inputX=r,wrAddrM=Just a}
      Nop                  -&gt; nullCode

    -- ALU
    regX   = regbank <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code> inputX
    regY   = regbank <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:-33--33-">!!</a></code> inputY
    aluOut = alu aluCode regX regY

    -- next instruction
    nextPC = case jmpM of
               Just a | aluOut /= 0 -&gt; ipntr + a
               _                    -&gt; ipntr + 1

    -- update registers
    ldRegD'  = ldReg -- Delay the ldReg by 1 cycle
    regbank' = <code>replace</code> Zero   0
             $ <code>replace</code> PC     nextPC
             $ <code>replace</code> result aluOut
             $ <code>replace</code> ldRegD memOut
             $ regbank
</pre><p>We can now finally instantiate our system with a <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code>:</p><pre>system3 :: KnownNat n =&gt; Vec n Instruction -&gt; Signal Value
system3 instrs = memOut
  where
    memOut = <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code> (replicate d32 0) rdAddr dout
    (rdAddr,dout,ipntr) = <code>mealyB</code> cpu2 ((<code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-OldList.html#v:replicate">replicate</a></code> d7 0),Zero) (memOut,instr)
    instr  = <code><a href="CLaSH-Prelude-ROM.html#v:asyncRom">asyncRom</a></code> instrs <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Functor.html#v:-60--36--62-">&lt;$&gt;</a></code> ipntr
</pre><p>We are, however, not done. We will also need to update our program. The reason
being that values that we try to load in our registers won't be loaded into the
register until the next cycle. This is a problem when the next instruction
immediately depended on this memory value. In our case, this was only the case
when the loaded the value <code>6</code>, which was stored at address <code>1</code>, into <code>RegB</code>.
Our updated program is thus:</p><pre>prog2 = -- 0 := 4
       Compute Incr Zero RegA RegA :&gt;
       replicate d3 (Compute Incr RegA Zero RegA) ++
       Store RegA 0 :&gt;
       -- 1 := 6
       Compute Incr Zero RegA RegA :&gt;
       replicate d5 (Compute Incr RegA Zero RegA) ++
       Store RegA 1 :&gt;
       -- A := 4
       Load 0 RegA :&gt;
       -- B := 6
       Load 1 RegB :&gt;
       Nop :&gt; -- Extra NOP
       -- start
       Compute CmpGt RegA RegB RegC :&gt;
       Branch RegC 4 :&gt;
       Compute CmpGt RegB RegA RegC :&gt;
       Branch RegC 4 :&gt;
       Jump 5 :&gt;
       -- (a &gt; b)
       Compute Sub RegA RegB RegA :&gt;
       Jump (-6) :&gt;
       -- (b &gt; a)
       Compute Sub RegB RegA RegB :&gt;
       Jump (-8) :&gt;
       -- end
       Store RegA 2 :&gt;
       Load 2 RegC :&gt;
       Nil
</pre><p>When we simulate our system we see that it works. This time again,
we need to drop the first sample, because the initial output of a
<code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code> is <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code>, and consequently, the first output sample is
also <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code>.</p><pre>&gt;&gt;&gt; printX $ sampleN 33 $ system3 prog2
[X,0,0,0,0,0,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2]

</pre><p>This concludes the short introduction to using <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code>.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:blockRam">blockRam</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#t:Enum">Enum</a> addr) =&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> n a -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> addr -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a</li><li class="src short"><a href="#v:blockRamPow2">blockRamPow2</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> (2 <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:-94-">^</a> n) a -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n) -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n, a)) -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a</li><li class="src short"><a href="#v:blockRam-39-">blockRam'</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#t:Enum">Enum</a> addr) =&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk -&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> n a -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk addr -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</li><li class="src short"><a href="#v:blockRamPow2-39-">blockRamPow2'</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk -&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> (2 <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:-94-">^</a> n) a -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n) -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n, a)) -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</li><li class="src short"><a href="#v:readNew">readNew</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> addr =&gt; (<a href="CLaSH-Signal.html#t:Signal">Signal</a> addr -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a) -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> addr -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a</li><li class="src short"><a href="#v:readNew-39-">readNew'</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> addr =&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk -&gt; (<a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk addr -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a) -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk addr -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</li><li class="src short"><a href="#v:blockRam-35-">blockRam#</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk -&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> n a -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</li></ul></div><div id="interface"><h1 id="g:1">BlockRAM synchronised to the system clock</h1><div class="top"><p class="src"><a id="v:blockRam" class="def">blockRam</a> <a href="#v:blockRam" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#t:Enum">Enum</a> addr)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> n a</td><td class="doc"><p>Initial content of the BRAM, also
 determines the size, <code>n</code>, of the BRAM.</p><p><strong>NB</strong>: <strong>MUST</strong> be a constant.</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> addr</td><td class="doc"><p>Read address <code>r</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a))</td><td class="doc"><p>(write address <code>w</code>, value to write)</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a</td><td class="doc"><p>Value of the <code>blockRAM</code> at address <code>r</code> from the previous clock
 cycle</p></td></tr></table></div><div class="doc"><p>Create a blockRAM with space for <code>n</code> elements.</p><ul><li><strong>NB</strong>: Read value is delayed by 1 cycle</li><li><strong>NB</strong>: Initial output value is <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code></li></ul><pre>bram40 :: <code><a href="CLaSH-Signal.html#t:Signal">Signal</a></code> (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 6)
       -&gt; <code><a href="CLaSH-Signal.html#t:Signal">Signal</a></code> (Maybe (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 6, <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>))
       -&gt; <code><a href="CLaSH-Signal.html#t:Signal">Signal</a></code> <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>
bram40 = <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam">blockRam</a></code> (<code><a href="CLaSH-Sized-Vector.html#v:replicate">replicate</a></code> d40 1)
</pre><p>Additional helpful information:</p><ul><li>See <a href="CLaSH-Prelude-BlockRam.html#usingrams">CLaSH.Prelude.BlockRam</a> for more information on how to use a
 Block RAM.</li><li>Use the adapter <code><a href="CLaSH-Prelude-BlockRam.html#v:readNew">readNew</a></code> for obtaining write-before-read semantics like this: <code>readNew (blockRam inits) rd wrM</code>.</li></ul></div></div><div class="top"><p class="src"><a id="v:blockRamPow2" class="def">blockRamPow2</a> <a href="#v:blockRamPow2" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> (2 <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:-94-">^</a> n) a</td><td class="doc"><p>Initial content of the BRAM, also
 determines the size, <code>2^n</code>, of the BRAM.</p><p><strong>NB</strong>: <strong>MUST</strong> be a constant.</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n)</td><td class="doc"><p>Read address <code>r</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n, a))</td><td class="doc"><p>(write address <code>w</code>, value to write)</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a</td><td class="doc"><p>Value of the <code>blockRAM</code> at address <code>r</code> from the previous clock
 cycle</p></td></tr></table></div><div class="doc"><p>Create a blockRAM with space for 2^<code>n</code> elements</p><ul><li><strong>NB</strong>: Read value is delayed by 1 cycle</li><li><strong>NB</strong>: Initial output value is <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code></li></ul><pre>bram32 :: <code><a href="CLaSH-Signal.html#t:Signal">Signal</a></code> (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 5)
       -&gt; <code><a href="CLaSH-Signal.html#t:Signal">Signal</a></code> (Maybe (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 5, <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>))
       -&gt; <code><a href="CLaSH-Signal.html#t:Signal">Signal</a></code> <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>
bram32 = <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRamPow2">blockRamPow2</a></code> (<code><a href="CLaSH-Sized-Vector.html#v:replicate">replicate</a></code> d32 1)
</pre><p>Additional helpful information:</p><ul><li>See <a href="CLaSH-Prelude-BlockRam.html#usingrams">CLaSH.Prelude.BlockRam</a> for more information on how to use a
 Block RAM.</li><li>Use the adapter <code><a href="CLaSH-Prelude-BlockRam.html#v:readNew">readNew</a></code> for obtaining write-before-read semantics like this: <code>readNew (blockRamPow2 inits) rd wrM</code>.</li></ul></div></div><h1 id="g:2">BlockRAM synchronised to an arbitrary clock</h1><div class="top"><p class="src"><a id="v:blockRam-39-" class="def">blockRam'</a> <a href="#v:blockRam-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n, <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#t:Enum">Enum</a> addr)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk</td><td class="doc"><p><code>Clock</code> to synchronize to</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> n a</td><td class="doc"><p>Initial content of the BRAM, also
 determines the size, <code>n</code>, of the BRAM.</p><p><strong>NB</strong>: <strong>MUST</strong> be a constant.</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk addr</td><td class="doc"><p>Read address <code>r</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a))</td><td class="doc"><p>(write address <code>w</code>, value to write)</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</td><td class="doc"><p>Value of the <code>blockRAM</code> at address <code>r</code> from the previous clock
 cycle</p></td></tr></table></div><div class="doc"><p>Create a blockRAM with space for <code>n</code> elements</p><ul><li><strong>NB</strong>: Read value is delayed by 1 cycle</li><li><strong>NB</strong>: Initial output value is <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code></li></ul><pre>type ClkA = Clk &quot;A&quot; 100

clkA100 :: SClock ClkA
clkA100 = <code><a href="CLaSH-Signal-Explicit.html#v:sclock">sclock</a></code>

bram40 :: <code><a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a></code> ClkA (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 6)
       -&gt; <code><a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a></code> ClkA (Maybe (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 6, <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>))
       -&gt; <code><a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a></code> ClkA <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>
bram40 = <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRam-39-">blockRam'</a></code> clkA100 (<code><a href="CLaSH-Sized-Vector.html#v:replicate">replicate</a></code> d40 1)
</pre><p>Additional helpful information:</p><ul><li>See <a href="CLaSH-Prelude-BlockRam.html#usingrams">CLaSH.Prelude.BlockRam</a> for more information on how to use a
 Block RAM.</li><li>Use the adapter <code><a href="CLaSH-Prelude-BlockRam.html#v:readNew-39-">readNew'</a></code> for obtaining write-before-read semantics like this: <code>readNew' clk (blockRam' clk inits) rd wrM</code>.</li></ul></div></div><div class="top"><p class="src"><a id="v:blockRamPow2-39-" class="def">blockRamPow2'</a> <a href="#v:blockRamPow2-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk</td><td class="doc"><p><code>Clock</code> to synchronize to</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> (2 <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:-94-">^</a> n) a</td><td class="doc"><p>Initial content of the BRAM, also
 determines the size, <code>2^n</code>, of
 the BRAM.</p><p><strong>NB</strong>: <strong>MUST</strong> be a constant.</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n)</td><td class="doc"><p>Read address <code>r</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a> n, a))</td><td class="doc"><p>(Write address <code>w</code>, value to write)</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</td><td class="doc"><p>Value of the <code>blockRAM</code> at address <code>r</code> from the previous
 clock cycle</p></td></tr></table></div><div class="doc"><p>Create a blockRAM with space for 2^<code>n</code> elements</p><ul><li><strong>NB</strong>: Read value is delayed by 1 cycle</li><li><strong>NB</strong>: Initial output value is <code><a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Prelude.html#v:undefined">undefined</a></code></li></ul><pre>type ClkA = Clk &quot;A&quot; 100

clkA100 :: SClock ClkA
clkA100 = <code><a href="CLaSH-Signal-Explicit.html#v:sclock">sclock</a></code>

bram32 :: <code><a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a></code> ClkA (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 5)
       -&gt; <code><a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a></code> ClkA (Maybe (<code><a href="CLaSH-Sized-Internal-Unsigned.html#t:Unsigned">Unsigned</a></code> 5, <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>))
       -&gt; <code><a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a></code> ClkA <code><a href="CLaSH-Sized-BitVector.html#v:Bit">Bit</a></code>
bram32 = <code><a href="CLaSH-Prelude-BlockRam.html#v:blockRamPow2-39-">blockRamPow2'</a></code> clkA100 (<code><a href="CLaSH-Sized-Vector.html#v:replicate">replicate</a></code> d32 1)
</pre><p>Additional helpful information:</p><ul><li>See <a href="CLaSH-Prelude-BlockRam.html#usingrams">CLaSH.Prelude.BlockRam</a> for more information on how to use a
 Block RAM.</li><li>Use the adapter <code><a href="CLaSH-Prelude-BlockRam.html#v:readNew-39-">readNew'</a></code> for obtaining write-before-read semantics like this: <code>readNew' clk (blockRamPow2' clk inits) rd wrM</code>.</li></ul></div></div><h1 id="g:3">Read/Write conflict resolution</h1><div class="top"><p class="src"><a id="v:readNew" class="def">readNew</a> <a href="#v:readNew" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> addr</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<a href="CLaSH-Signal.html#t:Signal">Signal</a> addr -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a)</td><td class="doc"><p>The <code>ram</code> component</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> addr</td><td class="doc"><p>Read address <code>r</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a))</td><td class="doc"><p>(Write address <code>w</code>, value to write)</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal.html#t:Signal">Signal</a> a</td><td class="doc"><p>Value of the <code>ram</code> at address <code>r</code> from the previous clock
 cycle</p></td></tr></table></div><div class="doc"><p>Create read-after-write blockRAM from a read-before-write one (synchronised to system clock)</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import CLaSH.Prelude
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:t readNew (blockRam (0 :&gt; 1 :&gt; Nil))
</code></strong>readNew (blockRam (0 :&gt; 1 :&gt; Nil))
  :: ... =&gt;
     Signal addr -&gt; Signal (Maybe (addr, a)) -&gt; Signal a
</pre></div></div><div class="top"><p class="src"><a id="v:readNew-39-" class="def">readNew'</a> <a href="#v:readNew-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> addr</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (<a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk addr -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a)) -&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a)</td><td class="doc"><p>The <code>ram</code> component</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk addr</td><td class="doc"><p>Read address <code>r</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk (<a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (addr, a))</td><td class="doc"><p>(Write address <code>w</code>, value to write)</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</td><td class="doc"><p>Value of the <code>ram</code> at address <code>r</code> from the previous clock
 cycle</p></td></tr></table></div><div class="doc"><p>Create read-after-write blockRAM from a read-before-write one (synchronised to specified clock)</p></div></div><h1 id="g:4">Internal</h1><div class="top"><p class="src"><a id="v:blockRam-35-" class="def">blockRam#</a> <a href="#v:blockRam-35-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="CLaSH-Signal-Internal.html#t:SClock">SClock</a> clk</td><td class="doc"><p><code>Clock</code> to synchronize to</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Sized-Vector.html#t:Vec">Vec</a> n a</td><td class="doc"><p>Initial content of the BRAM, also
 determines the size, <code>n</code>, of the BRAM.</p><p><strong>NB</strong>: <strong>MUST</strong> be a constant.</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Read address <code>r</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></td><td class="doc"><p>Write enable</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk <a href="file:///Library/Frameworks/GHC.framework/Versions/8.0.2-x86_64/usr/share/doc/ghc-8.0.2/html/libraries/base-4.9.1.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Write address <code>w</code></p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</td><td class="doc"><p>Value to write (at address <code>w</code>)</p></td></tr><tr><td class="src">-&gt; <a href="CLaSH-Signal-Internal.html#t:Signal-39-">Signal'</a> clk a</td><td class="doc"><p>Value of the <code>blockRAM</code> at address <code>r</code> from the previous clock
 cycle</p></td></tr></table></div><div class="doc"><p>blockRAM primitive</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>